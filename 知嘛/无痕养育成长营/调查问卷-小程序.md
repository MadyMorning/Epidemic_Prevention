**host:**
**测试地址:**
**https://zdata.zmedc.com/edugrown/**
**请求方式：POST**

# 错误码：

10010 提交失败
10011 问卷已停止收集
10012 必选题必须填写
10013 您已经回答过该问卷了
10020 您没有该问卷

# 1.小程序问卷列表:
**请求地址：`Questionnaire/getQuestionaireList`**

#### POST参数:
| 字段名称  | 字段说明 |  类型  | 必填 |   备注 |
| --------- | :------: | :----: | :--: | -----: |
| page_size | 一页几条 | string |  N   | 默认10 |
| page_num  |  第几页  | string |  N   |  默认1 |
| unionid   | unionid  | string |  Y   |      - |


### 请求返回结果参数说明:
| 字段名称           |               字段说明                |  类型  | 必填 | 备注 |
| ------------------ | :-----------------------------------: | :----: | :--: | ---: |
| code               |              200 即成功               | string |  Y   |    - |
| msg                |                                       | string |  Y   |    - |
| result             |                                       | string |  Y   |    - |
| questionaireList   |               问卷列表                | string |  Y   |    - |
| id                 |                  id                   | string |  Y   |    - |
| questionnaire_code |               问卷编码                | string |  Y   |    - |
| remarks            |                 备注                  | string |  Y   |    - |
| finish_num         |                完成数                 | string |  Y   |    - |
| join_num           |                参与数                 | string |  Y   |    - |
| title              |                 标题                  | string |  Y   |    - |
| status             | 状态 1：草稿 2:收集中 3已暂停 4已结束 | string |  Y   |    - |
| wx_share_title     |             微信分享标题              | string |  Y   |    - |
| wx_share_pic       |             微信分享图片              | string |  Y   |    - |
| wx_share_intro     |             微信分享简介              | string |  Y   |    - |
| create_time        |               创建时间                | string |  Y   |    - |
| page_size          |               一页几条                | string |  N   |    - |
| page_num           |                第几页                 | string |  N   |    - |
| count              |                 总数                  | string |  Y   |    - |
**返回结果示例json:**


```json
{
    "code": 200,
    "msg": "OK",
    "result": {
        "questionaireList": [
            {
                "id": "123",
                "questionnaire_code": "abc",
                "remarks": "备注",
                "finish_num": "完成数 100",
                "join_num": "参与人数 100",
                "title": "标题",
                "status": "状态 1：草稿 2:收集中 3已暂停 4已结束 ",
                "create_time": "2020-02-28 10:10:10"
            }
        ],
        "count": "10"
    }
}
```


# 2.小程序问卷详情:
**请求地址：`Questionnaire/getQuestionnaire`**

#### POST参数:
| 字段名称           |  字段说明  |  类型  | 必填 |                备注 |
| ------------------ | :--------: | :----: | :--: | ------------------: |
| questionnaire_code |    编码    | string |  Y   |                   - |
| unionid            |  unionid   | string |  Y   |                   - |
| is_preview         | 是否是预览 | string |  Y   | 1 是，2 不是，默认2 |

**mock数据:**
```json
{
  "code": "200",
  "msg": "ok",
  "result": {
    "questionaireInfo": {
      "id": "123",
      "questionnaire_code": "abc",
      "title": "问卷标题",
      "intro": "简介",
      "success_tips": "用户提交成功的提示语",
      "remarks": "备注",
      "status": "2"
    },
    "componentList": [
      {
        "componentInfo": {
          "component_id": "abc",
          "component_type": "1",
          "style_type": "1",
          "is_must_answer": "1",
          "compontent_sort": "1",
          "title": "今天你吃什么？"
        },
        "optionList": [
          {
            "option_id": "qwe",
            "option_name": "我吃牛排",
            "option_sort": "1",
            "show_type": "1",
            "option_index": "A",
            "is_select":1
          }
        ]
      },
      {
        "componentInfo": {
          "component_id": "abc",
          "component_type": "2",
          "style_type": "2",
          "is_must_answer": "2",
          "compontent_sort": "2",
          "title": "今天你喝什么？",
          "low_select_limit": "1",
          "high_select_limit": "2"
        },
        "optionList": [
          {
            "option_id": "qwe",
            "option_name": "喝白水",
            "option_sort": "1",
            "show_type": "1",
            "option_index": "A",
            "is_select":0
          }
        ]
      },
      {
        "componentInfo": {
          "component_id": "abc",
          "component_type": "3",
          "is_must_answer": "1",
          "compontent_sort": "3",
          "size_style": "3",
          "title": "你今天上班吗？"
        }
      },
      {
        "componentInfo": {
          "component_id": "abc",
          "component_type": "4",
          "is_must_answer": "1",
          "compontent_sort": "4",
          "title": "你对今天的天气打几分?",
          "ready_fill":"98分"
        },
        "optionList": [
          {
            "option_id": "qwe",
            "option_name": "",
            "option_sort": "1",
            "option_index": "A",
            "score": "5",
            "is_select":1
          }
        ]
      }
    ]
  }
}
```

### 请求返回结果参数说明:
| 字段名称 |                 字段说明                  |  类型  | 必填 | 备注 |
| -------- | :---------------------------------------: | :----: | :--: | ---: |
| code     | 200 即成功 -11缺少参数 -12 该问卷状态异常 | string |  Y   |    - |
| msg      |                                           | string |  Y   |    - |
| result   |                                           | string |  Y   |    - |
**返回结果示例json:**
```json
{
  "questionaireInfo": {
    "id": "123",
    "questionnaire_code": "问卷编码  abc",
    "title": "问卷标题",
    "intro": "简介",
    "remarks": "备注",
    "success_tips": "用户提交成功的提示语",
    "wx_share_title":"微信分享标题",
    "wx_share_pic":"微信分享图片",
    "wx_share_intro":"微信分享简介"
    "status": "状态 1：草稿 2:收集中 3已暂停 4已结束 5用户已完成 6问卷已删除 7中途退出",
    "err_msg":"status=3|status=5|status=6|status=7的提示语",
    "begin_time":"当前时间 Y-m-d H:i:s"
  },
  "componentList": [
    {
      "componentInfo": {
        "component_id": "abc",
        "component_type": "1 单选",
        "style_type": "样式风格 1：单列 2:双列 3:三列",
        "is_must_answer": "1:必填 2:非必填",
        "compontent_sort": "组件排序 1",
        "title": "问题名称"
      },
      "optionList": [
        {
          "option_id": "abc",
          "option_name": "选项名称",
          "option_sort": "选项排序 1 ,2 ,3,4,5 对应 option_index",
          "show_type": "展示形式 1：正常选项 2：可文本输入 该字段为2时 option_name为其他 前端写死即可 3.图片选项",
          "option_index": "A B C D 选项号",
          "option_img_url": "www.baidu.com/123.jpg",
          "is_select":"用户是否选择 1 是 0 否"
        }
      ]
    },
    {
      "componentInfo": {
        "component_id": "abc",
        "component_type": "2 多选",
        "style_type": "样式风格 1：单列 2:双列 3:三列",
        "is_must_answer": "1:必填 2:非必填",
        "compontent_sort": "组件排序 2",
        "title": "问题名称",
        "low_select_limit": "1 最少选几个  0为不限制",
        "high_select_limit": "2 最多选几个 0为不限制"
      },
      "optionList": [
        {
          "option_id": "abc",
          "option_name": "选项名称",
          "option_sort": "选项排序",
          "show_type": "展示形式 1：正常选项 2：可文本输入 该字段为2时 option_name为其他 前端写死即可 3.图片选项",
          "option_index": "A B C D 选项号",
          "option_img_url": "www.baidu.com/123.jpg",
          "is_select":"用户是否选择 1 是 0 否"
        }
      ]
    },
    {
      "componentInfo": {
        "component_id": "abc",
        "component_type": "3 填空",
        "is_must_answer": "1:必填 2:非必填",
        "compontent_sort": "组件排序 3",
        "size_style": "布局 1小 2中 3大",
        "title": "填空题标题",
        "ready_fill":"用户已填写内容 98分"
      }
    },
    {
      "componentInfo": {
        "component_id": "abc",
        "component_type": "4 打分",
        "is_must_answer": "1:必填 2:非必填",
        "compontent_sort": "组件排序 4",
        "title": "题目标题"
      },
      "optionList": [
        {
          "option_id": "abc",
          "option_name": "选项名称",
          "option_sort": "选项排序 1 ,2 ,3,4,5 对应 option_index",
          "option_index": "A B C D 选项号",
          "score": "分值",
          "is_select":"用户是否选择 1 是 0 否"
        }
      ]
    }
  ],
  "answer_list":"答案列表"
}

```

# 3.小程序提交问卷:
**请求地址：`Questionnaire/submitQuestionnaire`**

**请求方式：POST**

| 字段名称           | 字段说明               | 类型     | 是否必传 | 备注        |
| ------------------ | ---------------------- | -------- | -------- | ----------- |
| unionid            | 用户unionID            | string   | 是       |             |
| questionnaire_code | 问卷编码               | string   | 是       |             |
| begin_time         | 开始时间               | datetime | 是       |             |
| is_click           | 是否是点击提交按钮提交 | int      | 是       | 1：是 2：否 |
| componentList      | 答题组件列表           | array    | 是       | 见下表      |

component_type == 1（单选）：

| 字段名称          | 字段说明                   | 类型   | 是否必传 | 备注                                 |
| ----------------- | -------------------------- | ------ | -------- | ------------------------------------ |
| componentList     | 答题组件列表               | string | 是       |                                      |
| --component_id    | 组件ID                     | string | 是       |                                      |
| --component_type  | 组件类型                   | string | 是       | 1单选 2多选 3填空 4评分              |
| --compontent_sort | 组件排序                   | int    | 是       |                                      |
| --option_id       | 选项ID                     | string | 是       |                                      |
| --show_type       | 选项类型                   | int    | 是       | 1：正常选项 2：可文本输入 3.图片选项 |
| --option_value    | "其他"选项用户自输入的内容 | string | 否       | show_type==2时传递                   |
| --option_img_url  | 图片                       | string | 否       | show_type==3时传递                   |

```json
"componentList":[
		{
			"component_id":"",
			"component_type":"",
			"option_id":"",
                        "show_type":"",
			"option_value":"",
			"option_img_url":""
		}
    ]
```

component_type == 2（多选）：

| 字段名称           | 字段说明                   | 类型   | 是否必传 | 备注                                 |
| ------------------ | -------------------------- | ------ | -------- | ------------------------------------ |
| componentList      | 答题组件列表               | string | 是       |                                      |
| --component_id     | 组件ID                     | string | 是       |                                      |
| --component_type   | 组件类型                   | string | 是       | 1单选 2多选 3填空 4评分              |
| --compontent_sort  | 组件排序                   | int    | 是       |                                      |
| --optionList       | 选项列表                   | array  | 是       |                                      |
| ----option_id      | 选项ID                     | string | 是       |                                      |
| ----show_type      | 选项类型                   | int    | 是       | 1：正常选项 2：可文本输入 3.图片选项 |
| ----option_value   | "其他"选项用户自输入的内容 | string | 否       | show_type==2时传递                   |
| ----option_img_url | 图片                       | string | 否       | show_type==3时传递                   |

```json
"componentList":[
		{
			"component_id":"",
			"component_type":"",
			"optionList":[
				{
					"option_id":"",
                                        "show_type":"",
					"option_value":"",
					"option_img_url":""
				},
				{
					"option_id":"",
                                        "show_type":"",
					"option_value":"",
					"option_img_url":""
				}
			]
		}
	]
```

component_type == 3（填空）：

| 字段名称          | 字段说明       | 类型   | 是否必传 | 备注                    |
| ----------------- | -------------- | ------ | -------- | ----------------------- |
| componentList     | 答题组件列表   | string | 是       |                         |
| --component_id    | 组件ID         | string | 是       |                         |
| --component_type  | 组件类型       | string | 是       | 1单选 2多选 3填空 4评分 |
| --compontent_sort | 组件排序       | int    | 是       |                         |
| --fill_content    | 用户填空的信息 | string | 是       |                         |

```json
"componentList":[
		{
			"component_id":"",
			"component_type":"",
			"fill_content":""
		}
    ]
```

component_type == 4（评分）：

| 字段名称          | 字段说明     | 类型   | 是否必传 | 备注                    |
| ----------------- | ------------ | ------ | -------- | ----------------------- |
| componentList     | 答题组件列表 | string | 是       |                         |
| --component_id    | 组件ID       | string | 是       |                         |
| --component_type  | 组件类型     | string | 是       | 1单选 2多选 3填空 4评分 |
| --compontent_sort | 组件排序     | int    | 是       |                         |
| --option_id       | 选项ID       | string | 是       |                         |

```json
"componentList":[
		{
			"component_id":"",
			"component_type":"",
			"option_id":"",
		}
    ]
```

**示例**

```json
{
    "unionid": "用户unionID",
    "questionnaire_code": "问卷编码:quest_5b5f25a3edddc",
    "begin_time": "开始时间:2020-02-28 13:41:00",
    "is_click": "是否是点击提交按钮提交:1",
    "componentList": [
        {
            "component_id": "组件ID:component_5b5f25a3edddc",
            "component_type": "组件类型:1",
            "component_sort": "组件排序:1",
            "option_id": "选项ID:option_89901d7c3bfa5",
            "show_type": "选项类型:1"
        },
        {
            "component_id": "组件ID:component_5b5f25a3edddc",
            "component_type": "组件类型:2",
            "component_sort": "组件排序:2",
            "optionList": [
                {
                    "option_id": "选项ID:option_89901d7c3bfa5",
                    "show_type": "选项类型:2",
                    "option_value": "'其他'选项用户自输入的内容:壹佰贰拾叁万肆仟陆佰柒拾"
                },
                {
                    "option_id": "选项ID:option_89901d7c3bfa5",
                    "show_type": "选项类型:3",
                    "option_img_url": "图片:www.baidu.com/123.jpg"
                }
            ]
        },
        {
            "component_id": "组件ID:component_5b5f25a3edddc",
            "component_type": "组件类型:3",
            "component_sort": "组件排序:3",
            "fill_content": "用户填空的信息:壹佰贰拾叁万肆仟陆佰柒拾"
        },
        {
            "component_id": "组件ID:component_5b5f25a3edddc",
            "component_type": "组件类型:4",
            "component_sort": "组件排序:4",
            "option_id": "选项ID:option_89901d7c3bfa5"
        }
    ]
}
```
**返回示例**

成功：
```json
{
   "code": "200",
   "msg": "您已完成本次问卷，感谢您的帮助与支持",
   "result": ""
}
```

失败：
```json
{
   "code": "10010",
   "msg": "提交失败",
   "result": ""
}
```
```json
{
   "code": "10011",
   "msg": "问卷已停止收集",
   "result": ""
}
```
```json
{
   "code": "10012",
   "msg": "必选题必须填写",
   "result":{
		"list":["component_5b5f25a3edddc","component_5b5f25a3edddc"]
	}
}
```

# 4.分享二维码

**请求地址：`Questionnaire/shareQRcode`**

**请求参数：**

| 参数名称           | 类型   | 说明        | 是否必须 | 备注                      |
| ------------------ | ------ | ----------- | -------- | ------------------------- |
| questionnaire_code | string | 问卷编码    | Y        |                           |
| unionid            | string | 用户unionid | Y        |                           |
| path               | string | 前端 path   | Y        |                           |
| qrcode_type        | int    | 二维码类型  | Y        | 1:小程序二维码 2:H5二维码 |

**返回参数：**

| 参数名称   | 类型   | 说明         | 示例                      |
| ---------- | ------ | ------------ | ------------------------- |
| code       | string | 返回编码     | 200:请求成功,100:请求失败 |
| msg        | string | 返回信息描述 | 请求成功或请求失败        |
| result     | object | 返回数据     |                           |
| ---picture | string | 返回图片url  |                           |

**返回结果示例json:**

成功：

 ```json
{
    "code": 200,
    "msg": "OK",
    "result": {
           "picture":"zm-edu-image.zmedc.com/zhima/zhima.jpg"
    }
}

 ```

失败：

```json
{
    "code": 10010,
    "msg": "生成二维码失败",
    "result": ""
}
```